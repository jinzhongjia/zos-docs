# 1 什么是中断？

CPU 通过时分复用来处理很多任务，这其中包括一些硬件任务，例如磁盘读写、键盘输入，也包括一些软件任务，例如网络包处理。 在任意时刻，一个 CPU 只能处理一个任务。 当某个硬件或软件任务此刻没有执行，但它希望 CPU 来立即处理时，就会给 CPU 发送一个中断请求 —— 希望 CPU 停下手头的工作，优先服务“我”。 中断是以事件的方式通知 CPU 的，因此我们常看到 “XX 条件下会触发 XX 中断事件” 的表述。

两种类型：

外部或硬件产生的中断，例如键盘按键。

软件产生的中断，异常事件产生的中断，例如除以零 。

管理中断的设备：Advanced Programmable Interrupt Controller（APIC，高级可编程中断控制器）。

# 2 硬中断

## 2.1 中断处理流程

中断随时可能发生，发生之后必须马上得到处理。收到中断事件后的处理流程：

抢占当前任务：内核必须暂停正在执行的进程；
执行中断处理函数（ISR）：找到对应的中断处理函数，将 CPU 交给它（执行）；

ISR 位于 Interrupt Vector table，这个 table 位于内存中的固定地址。

中断处理完成之后：第 1 步被抢占的进程恢复执行。

在中断处理完成之后，处理器恢复执行被中断的进程（resume the interrupted process）。
